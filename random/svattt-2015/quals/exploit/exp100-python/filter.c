
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int blacklist(char* buffer){
	char line[32];
	int i;
	FILE* fd;
	fd = fopen("./blacklist", "r");
	
	
	
	while (1) {
        if (fgets(line,32, fd) == NULL) break;
        i++;
		if (line[0] == '\r' || line[0] == '\n') continue;
		if (line[strlen(line)-1] == '\n')
			line[strlen(line)-1] = '\0';
		//printf("%s\n",line);
        if(strstr(buffer,line)) return 1;
	}
	
	if(check_extension(buffer)) return 1;
	
	fclose(fd);
	
	return 0;
}

void egg(){
	system("cat flag");
}

int check_extension(char *filename){
	
	char buffer[64];

	memcpy(buffer,filename,strlen(filename));
	
	if(strstr(buffer,".c")) return 1;
	if(strstr(buffer,".py")) return 1;
	if(strstr(buffer,".so")) return 1;
	

	return 0;
}

