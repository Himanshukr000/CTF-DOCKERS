import sys

flag='GH18{I_H3rD_U_like_XoRz!S0_I_X0r3D_Y0Ur_XORs!}'
key=[0] * len(flag)
flk=[0] * len(flag)
Input=[0x92, 0xde, 0x4f, 0xc0, 0x5b, 0xcb, 0xd0, 0xd8,
       0x8b, 0xf7, 0x7d, 0x9c, 0x73, 0x82, 0xfa, 0x7d,
       0x7b, 0x95, 0x9e, 0xaa, 0x2c, 0x7f, 0x03, 0xe8,
       0x96, 0x2e, 0x2b, 0xb7, 0x5c, 0x53, 0xd5, 0x02,
       0xa4, 0x08, 0x07, 0x3e, 0xb8, 0x8e, 0x1d, 0xbd,
       0x5c, 0x35, 0xff, 0x0d, 0xb0, 0x0a]
xor=ord('^')

for i in range(len(flag)):
    key[i] = xor ^ Input[i]
    flk[i] = ord(flag[i]) ^ key[i] ^ Input[i]
    xor = key[i]

if len(sys.argv) <= 1 or sys.argv[1] == "gen":
    print('char flk_byte[' + str(len(flk)) + '] = {' + ','.join(hex(k) for k in flk) + '};')
    print('char key[' + str(len(key)) + '] = {' + ','.join(hex(k) for k in key) + '};')
if len(sys.argv) > 1 and sys.argv[1] == "solve":
    sys.stdout.buffer.write(bytes(Input))
