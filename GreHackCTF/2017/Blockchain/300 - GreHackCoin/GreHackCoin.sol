/*

Binary: 
6060604052341561000f57600080fd5b5b610018610073565b604051809103906000f080151561002e57600080fd5b6000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b610083565b60405161068380610ada83390190565b610a48806100926000396000f3006060604052361561008c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806323b872dd1461009057806341c0e1b514610109578063473ca96c1461011e5780639a777d5d14610133578063a9059cbb1461013d578063cfed3b911461017f578063dd62ed3e146101d4578063f8b2cb4f14610240575b5b5b005b341561009b57600080fd5b6100ef600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061028d565b604051808215151515815260200191505060405180910390f35b341561011457600080fd5b61011c6105b8565b005b341561012957600080fd5b6101316106fb565b005b61013b61074b565b005b341561014857600080fd5b61017d600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506107a7565b005b341561018a57600080fd5b610192610923565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156101df57600080fd5b61022a600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610948565b6040518082815260200191505060405180910390f35b341561024b57600080fd5b610277600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506109d2565b6040518082815260200191505060405180910390f35b60008073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141515156102ca57600080fd5b600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054821115151561031857600080fd5b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205482111515156103a357600080fd5b81600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205403600160008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555081600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205401600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555081600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205403600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600190505b9392505050565b7f746f6b696c6c00000000000000000000000000000000000000000000000000006000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166362f4ed90826000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808260001916600019168152602001915050602060405180830381600087803b151561067957600080fd5b6102c65a03f1151561068a57600080fd5b50505060405180519050151561069f57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc3073ffffffffffffffffffffffffffffffffffffffff16319081150290604051600060405180830381858888f1935050505015156106f657600080fd5b5b5b50565b60003073ffffffffffffffffffffffffffffffffffffffff16311415610748577f29822734f2619c764b25a111ff2328da08e02d6652fc891eb80227a6ec58774360405160405180910390a15b5b565b60023481151561075757fe5b04600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101515156107f557600080fd5b600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205481600160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054011015151561088457600080fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254019250508190555080600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055505b5050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600080600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b92915050565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a723058200ecba5b1c856adc847f8f081a89ed196a143e63c8871e7e37e8682df214e508b00296060604052341561000f57600080fd5b5b60005b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b61005c6101a1565b604051809103906000f080151561007257600080fd5b9050610090816101196401000000000261010a176401000000009004565b33600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b506101b1565b6000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614151561019d5780600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b50565b60405161019e806104e583390190565b610325806101c06000396000f30060606040523615610055576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630d0092971461005957806362f4ed9014610092578063a6f9dae1146100d1575b5b5b005b341561006457600080fd5b610090600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061010a565b005b341561009d57600080fd5b6100b7600480803560001916906020019091905050610192565b604051808215151515815260200191505060405180910390f35b34156100dc57600080fd5b610108600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610258565b005b6000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614151561018e5780600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b50565b6000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166362f4ed90836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808260001916600019168152602001915050602060405180830381600087803b151561023557600080fd5b6102c65a03f1151561024657600080fd5b5050506040518051905090505b919050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156102b357600080fd5b80600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b505600a165627a7a723058208b30ded03a76faa502905e83c760ee45e80ede220ff830aa2e175aa60efde6eb00296060604052341561000f57600080fd5b5b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b61013d806100616000396000f3006060604052361561003f576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806362f4ed9014610043575b5b5b005b341561004e57600080fd5b610068600480803560001916906020019091905050610082565b604051808215151515815260200191505060405180910390f35b60007f746f6b696c6c0000000000000000000000000000000000000000000000000000826000191614156100b9576000905061010c565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161490505b9190505600a165627a7a7230582093b653ee73a3e90431935e04e947fbbfcefe0e56b9e49bb8a8a072f600b338470029
Contract JSON ABI 
[{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"kill","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"win","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"buyCoins","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"amount","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"owner_lib","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"owner","type":"address"},{"name":"spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"u","type":"address"}],"name":"getBalance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[],"name":"Win","type":"event"}]

*/
pragma solidity ^0.4.16;

contract Owner{
    address owner;
    
    modifier onlyOwner(){
        require(msg.sender == owner);
        _;
    }
    
    function Owner(){
        owner = msg.sender;
    }

    function () payable {}
    
    function isAuthorized(bytes32 b) constant  returns (bool){
        if(b == "tokill"){
            return false;
        }
        return msg.sender == owner;    
    }    
}


// let us be updatable for the Future 
contract FuturOwner is Owner{
    address owner;
    Owner contract_owner;
    
    event Log(bool);
    
    function FuturOwner(){
        Owner o = new Owner();

        initOwner(o);

	owner = msg.sender;
    	contract_owner = o;
    }
    
    function initOwner(address c){
        if(address(contract_owner)!=0x0){
		contract_owner = Owner(c);
	}
    }    
    
    function changeOwner(address c) onlyOwner(){
        contract_owner = Owner(c);        
    }
    
    function isAuthorized(bytes32 b) constant returns(bool){
        return contract_owner.isAuthorized(b);
    }
}



contract GreHackCoin{
    FuturOwner public owner_lib;
    mapping (address => uint) coins;
    event Win();
    
    function win() public{
        if(this.balance ==0){
            Win();
        }
    }
    
    function () payable {}

    mapping (address => mapping (address => uint256)) internal allowed;
    
    modifier isAuthorized(bytes32 b){
        require(owner_lib.isAuthorized(b));
        _;
    }
    
    function GreHackCoin(){
        owner_lib = new FuturOwner();
    }
    
    function buyCoins() payable  public{
        // half of the price is going to the GreHack charity association
        coins[msg.sender] += msg.value/2;
    }   
 
    function getBalance(address u) constant  public returns(uint) {
        return coins[u];
    }
    
     function transfer(address to, uint amount){
        require(coins[msg.sender] >= amount);
        require(coins[to] + amount >= coins[to]);
        coins[to] += amount;
        coins[msg.sender] -= amount;
    }
    function allowance(address owner, address spender) public constant returns (uint256){
        allowed[msg.sender][spender] = 0; // protection against race condition in  https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729
    }
    
    function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {
        require(_to != address(0));
        require(_value <= coins[_from]);
        require(_value <= allowed[_from][msg.sender]);
    
        coins[_from] = coins[_from] - _value;
        coins[_to] = coins[_to] +_value;
        allowed[_from][msg.sender] = allowed[_from][msg.sender] - _value;
        return true;
    }
 
    function kill() isAuthorized("tokill"){
        msg.sender.transfer(this.balance);
    }
    
}
