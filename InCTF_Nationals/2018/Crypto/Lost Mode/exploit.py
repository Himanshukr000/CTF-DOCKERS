from Crypto.Util.number import *

data = open("flag.png.enc",'rb').read()
key=""
t = [137,80,78,71,13,10,26,10,0,0,0,13,ord('I'),ord('H'),ord('D'),ord('R')]

for i,j in zip(t,data[:16]):
	key+=chr(i^ord(j))
ct=[]
for i in range(0,len(data),16):
	if(i+16>len(data)):
		ct.append(data[i:len(data)])
	else:
		ct.append(data[i:i+16])

nexa=""
for i in range(0,len(ct)):
	nexa+="".join(chr(ord(a)^ord(b)) for a,b in zip(ct[i], key))
txt=open("fin.png","wb").write(nexa)
print("Done!")