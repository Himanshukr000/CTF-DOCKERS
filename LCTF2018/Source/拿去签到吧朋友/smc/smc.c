#include <stdio.h>
#define OFFSET 0x1279	//手动定位偏移量，不同版本编译器地址实现不一样
#define LEN    119		//手动计算长度
int main(int argc, char *argv[])
{
	FILE *p;
	unsigned char smc1[] = {85, 137, 229, 131, 236, 8, 232, 166, 254, 255, 255, 232, 212, 254, 255, 255, 201, 195,85, 137, 229, 131, 236, 8, 199, 69, 252, 0, 0, 0, 0, 100, 161, 48, 0, 0, 0, 15, 182, 64, 2, 137, 69, 252, 131, 125, 252, 1, 117, 12, 199, 4, 36, 0, 0, 0, 0, 232, 92, 101, 0, 0, 232, 48, 1, 0, 0, 201, 195};
	unsigned char smc2[] = {85, 137, 229, 129, 236, 88, 1, 0, 0, 199, 133, 200, 254, 255, 255, 40, 1, 0, 0, 199, 68, 36, 4, 0, 0, 0, 0, 199, 4, 36, 2, 0, 0, 0, 232, 194, 101, 0, 0, 131, 236, 8, 137, 133, 196, 254, 255, 255, 141, 133, 200, 254, 255, 255, 137, 68, 36, 4, 139, 133, 196, 254, 255, 255, 137, 4, 36, 232, 153, 101, 0, 0, 131, 236, 8, 137, 133, 192, 254, 255, 255, 131, 189, 192, 254, 255, 255, 0, 15, 132, 188, 0, 0, 0, 199, 133, 188, 254, 255, 255, 0, 0, 0, 0, 141, 133, 200, 254, 255, 255, 131, 192, 36, 137, 4, 36, 232, 212, 100, 0, 0, 57, 133, 188, 254, 255, 255, 115, 36, 141, 69, 248, 3, 133, 188, 254, 255, 255, 45, 16, 1, 0, 0, 15, 190, 64, 4, 137, 4, 36, 232, 170, 100, 0, 0, 141, 133, 188, 254, 255, 255, 255, 0, 235, 195, 199, 133, 184, 254, 255, 255, 0, 0, 0, 0, 131, 189, 184, 254, 255, 255, 7, 119, 60, 139, 149, 184, 254, 255, 255, 141, 133, 200, 254, 255, 255, 141, 72, 36, 139, 4, 149, 96, 129, 64, 0, 137, 68, 36, 4, 137, 12, 36, 232, 99, 100, 0, 0, 133, 192, 116, 12, 199, 4, 36, 0, 0, 0, 0, 232, 107, 100, 0, 0, 141, 133, 184, 254, 255, 255, 255, 0, 235, 187, 141, 133, 200, 254, 255, 255, 137, 68, 36, 4, 139, 133, 196, 254, 255, 255, 137, 4, 36, 232, 205, 100, 0, 0, 131, 236, 8, 137, 133, 192, 254, 255, 255, 233, 55, 255, 255, 255, 201, 195};
	unsigned char data[200] = {0};
	p = fopen(argv[1],"rb+");
	srand(3093);
	fseek(p,OFFSET,SEEK_SET);
	for(int i=0;i < LEN;i++){
		data[i] = fgetc(p);
		data[i] = data[i] ^ (rand()%256);
		data[i] = data[i] ^ smc2[i+119];
		data[i] = data[i] ^ smc2[i];
		if(i < 69){
			data[i] = data[i] ^ smc1[i];
		}
	}
	fseek(p,OFFSET,SEEK_SET);
	for(int i = 0;i < LEN;i++){
		fputc(data[i],p);
	}
	fclose(p);
}
//401D9B  401E11  401DAA
//55 89 E5 56 53 83 EC 08 B8 88 1E 40 00 FF E0
//85, 137, 229, 131, 236, 8, 232, 166, 254, 255, 255, 232, 212, 254, 255, 255, 201, 195
/*idapython
A = []
for i in range(0,18):
	A.append(Byte(0x40143F+i))
print A

A = []
for i in range(0,51):
	A.append(Byte(0x4012F0+i))
print A

A = []
for i in range(0,284):
	A.append(Byte(0x401323+i))
print A
 */